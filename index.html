<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Online Radio - Andit</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>üìª ONLINE RADIO</h1>

  <!-- üîé Search bar -->
  <div class="search-container">
    <input type="text" id="search" placeholder="Search radio...">
  </div>

  <!-- üìÇ Tabs -->
  <div class="tabs">
    <button id="tab-all" class="active">üìª All Radios</button>
    <button id="tab-fav">‚≠ê Favorites</button>
    <button id="toggle-layout">üîÄ Switch Layout</button>
  </div>
  
  <div id="radio-list" class="grid-view"></div>

  <footer>
    Made with ‚ù§Ô∏è by <b>Andit</b> &copy; 2026
  </footer>

  <script>
    let radiosData = [];

    async function loadRadios() {
      const container = document.getElementById('radio-list');
      try {
        const response = await fetch('radios.json');
        radiosData = await response.json();

        const savedFavs = JSON.parse(localStorage.getItem('favorites')) || [];
        radiosData.forEach(radio => {
          radio.favorite = savedFavs.includes(radio.title);
        });

        renderRadios(radiosData);

        // üîä Auto play first card (may be blocked until user interacts)
        const firstCard = document.querySelector('.radio-card');
        if (firstCard) {
          const firstAudio = firstCard.querySelector('audio');
          const firstBtn = firstCard.querySelector('.play-btn');
          firstAudio.muted = true; // start muted to allow autoplay
          firstAudio.play().then(() => {
            firstCard.classList.add('active');
            firstCard.querySelector('.status').textContent = '‚ñ∂ Auto Playing (muted)';
            firstBtn.querySelector('.icon-play').style.display = 'none';
            firstBtn.querySelector('.icon-pause').style.display = 'block';
            firstBtn.querySelector('.label').textContent = 'Pause';
          }).catch(() => {
            firstCard.querySelector('.status').textContent = '‚ö† Click Play to start';
          });
        }
      } catch (e) {
        container.innerHTML = "Failed to load radio data.";
      }
    }

    function renderRadios(radios) {
      const container = document.getElementById('radio-list');
      container.innerHTML = '';

      if (radios.length === 0) {
        container.innerHTML = "<p class='empty'>No favorites yet ‚≠ê</p>";
        return;
      }

      radios.forEach((radio, index) => {
        const card = document.createElement('div');
        card.className = 'radio-card';
        card.innerHTML = `
          <img src="${radio.logo}" alt="${radio.title}">
          <div class="card-content">
            <h3>${radio.title}</h3>
            <p class="status"></p>
            <audio>
              <source src="${radio.streamUrl}" type="${radio.type}">
            </audio>
            <button class="play-btn">
              <svg class="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
              <svg class="icon-pause" viewBox="0 0 24 24" style="display:none"><path d="M6 19h4V5H6zm8-14v14h4V5h-4z"/></svg>
              <span class="label">Play</span>
            </button>
            <button class="fav-btn">
              <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
              Favorite
            </button>
          </div>
        `;
        container.appendChild(card);

        const audio = card.querySelector('audio');
        const playBtn = card.querySelector('.play-btn');

        playBtn.addEventListener('click', () => {
          audio.muted = false; // unmute on user click
          if (audio.paused) {
            // pause all others
            document.querySelectorAll('audio').forEach(other => {
              if (other !== audio) {
                other.pause();
                other.currentTime = 0;
                const otherCard = other.closest('.radio-card');
                otherCard.classList.remove('active');
                otherCard.querySelector('.status').textContent = '';
                const otherBtn = otherCard.querySelector('.play-btn');
                otherBtn.querySelector('.icon-play').style.display = 'block';
                otherBtn.querySelector('.icon-pause').style.display = 'none';
                otherBtn.querySelector('.label').textContent = 'Play';
              }
            });
            audio.play();
            card.classList.add('active');
            card.querySelector('.status').textContent = '‚ñ∂ Now Playing';
            playBtn.querySelector('.icon-play').style.display = 'none';
            playBtn.querySelector('.icon-pause').style.display = 'block';
            playBtn.querySelector('.label').textContent = 'Pause';
          } else {
            audio.pause();
            card.classList.remove('active');
            card.querySelector('.status').textContent = '';
            playBtn.querySelector('.icon-play').style.display = 'block';
            playBtn.querySelector('.icon-pause').style.display = 'none';
            playBtn.querySelector('.label').textContent = 'Play';
          }
        });

        const favBtn = card.querySelector('.fav-btn');
        favBtn.addEventListener('click', () => {
          radiosData[index].favorite = !radiosData[index].favorite;
          favBtn.innerHTML = radiosData[index].favorite
            ? '<svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg> Favorited'
            : '<svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg> Favorite';

          const favTitles = radiosData.filter(r => r.favorite).map(r => r.title);
          localStorage.setItem('favorites', JSON.stringify(favTitles));
        });
      });
    }

    // Search filter
    document.getElementById('search').addEventListener('input', (e) => {
      const keyword = e.target.value.toLowerCase();
      const filtered = radiosData.filter(radio =>
        radio.title.toLowerCase().includes(keyword)
      );
      renderRadios(filtered);
    });

    // Tabs
    document.getElementById('tab-all').addEventListener('click', () => {
      document.getElementById('tab-all').classList.add('active');
      document.getElementById('tab-fav').classList.remove('active');
      renderRadios(radiosData);
    });

    document.getElementById('tab-fav').addEventListener('click', () => {
      document.getElementById('tab-fav').classList.add('active');
      document.getElementById('tab-all').classList.remove('active');
      const favRadios = radiosData.filter(radio => radio.favorite);
      renderRadios(favRadios);
    });

    // üîÄ Toggle layout
    document.getElementById('toggle-layout').addEventListener('click', () => {
      const list = document.getElementById('radio-list');
      list.classList.toggle('grid-view');
      list.classList.toggle('list-view');
    });

    loadRadios();
  </script>
</body>
</html>